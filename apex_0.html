<!DOCTYPE html>
<html>
 <!-- Required dependencies -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.6.1/prop-types.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/react/16.3.2/umd/react.production.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/16.3.2/umd/react-dom.production.min.js"></script>
 <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
 <!-- Optional dependencies -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/react-transition-group/2.2.1/react-transition-group.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/react-popper/0.10.4/umd/react-popper.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/reactstrap/6.0.1/reactstrap.min.js"></script>
 <script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
 
<head>
    <title>2020-02-18-BadMojo, LonelyLok, Plaasmatic</title>
</head>
<style>
.float-container {
    border: 3px solid #fff;
    padding: 20px;
}

.float-child {
    width: 40%;
    float: left;
    padding: 20px;
    border: 2px solid red;
}
.column {
  float: left;
  width: 33.33%;
  padding: 5px;
}
.row::after {
  content: "";
  clear: both;
  display: table;
}
</style>
<body style="width: 1500px; margin: auto;">
    <div id="mydiv"></div>
    <div class="float-container">
        <div class="float-child">
            <div id="c1" style="height: 300px"></div>
        </div>
        <div class="float-child">
            <div id="c2" style="height: 300px"></div>
        </div>
    </div>

    <div class="float-container">
        <div class="float-child">
            <div id="c3" style="height: 300px"></div>
        </div>
        <div class="float-child">
            <div id="c4" style="height: 300px"></div>
        </div>
    </div>

    <!-- <div><p><a href ="https://lonelylok.github.io/">Back</a></p></div> -->

    <script type="text/babel">

    const { Card, CardTitle, CardBody, CardText, CardImg } = Reactstrap;

    const date = '2020-02-18';

    const pictureMap = {
        'Loba': 'https://media.contentapi.ea.com/content/dam/apex-legends/images/2020/05/apex-grid-tile-legends-loba.png.adapt.crop16x9.png',
        'Lifeline': 'https://media.contentapi.ea.com/content/dam/apex-legends/images/2019/01/legends-character-tiles/apex-grid-tile-legends-lifeline.png.adapt.crop16x9.png',
        'Gibraltar': 'https://media.contentapi.ea.com/content/dam/apex-legends/images/2019/01/legends-character-tiles/apex-grid-tile-legends-gibraltar.png.adapt.crop16x9.png'
    }

    const gameChampData = [
        {id: 1, cham: false},
        {id: 2, cham: false},
        {id: 3, cham: false},
        {id: 4, cham: false},
        {id: 5, cham: false},
        {id: 6, cham: true}]
    const players = 
    [{id: 1, name: 'BadMojo1652', games:[
        {id: 1, damage: 131, kill:0, legend: 'Loba'},
        {id: 2, damage: 168, kill:0, legend: 'Loba'},
        {id: 3, damage: 134, kill:0, legend: 'Loba'},
        {id: 4, damage: 144, kill:0, legend: 'Loba'},
        {id: 5, damage: 170, kill:0, legend: 'Loba'},
        {id: 6, damage: 1480, kill:7, legend: 'Loba'}]},
    {id: 2, name:'Plaasmatic', games:[
        {id: 1, damage: 153, kill:1, legend: 'Lifeline'},
        {id: 2, damage: 0, kill:0, legend: 'Lifeline'},
        {id: 3, damage: 108, kill:0, legend: 'Revenant'},
        {id: 4, damage: 0, kill:0, legend: 'Lifeline'},
        {id: 5, damage: 0, kill:0, legend: 'Lifeline'},
        {id: 6, damage: 849, kill:1, legend: 'Lifeline'}]},
    {id: 3, name:'LonelyLok', games:[
        {id: 1, damage: 84, kill:0, legend: 'Gibraltar'},
        {id: 2, damage: 93, kill:0, legend: 'PathFinder'},
        {id: 3, damage: 50, kill:0, legend: 'Wraith'},
        {id: 4, damage: 48, kill:0, legend: 'Bangalore'},
        {id: 5, damage: 0, kill:0, legend: 'Caustic'},
        {id: 6, damage: 386, kill:1, legend: 'Mirage'}]}];

    const mostPlayLegend = p => p.map(({name, games})=>{
        const m = games.reduce((acc, curr)=>{
            if(!acc[curr.legend]){
                acc[curr.legend] = 0;
            }
            acc[curr.legend] += 1;
            return acc
        },{})
        return {
            name,
            legend: Object.keys(m).reduce((a, b) => m[a] > m[b] ? a : b)
        };
    })

        const options1 = {
        width: 500,
      title: {
        text: "Damage Per Game"
      },
      toolTip: {
		shared: true
	},
      data: players.map(({name, games})=>({
        type: "column",
        name,
        showInLegend: true, 
        legendText: name,
        dataPoints: games.map(({id, damage})=>({
            label: `Game${id}`, y: damage
        }))
    }))
   }

   const options2 = {
	animationEnabled: true,
	title: {
		text: 'Total Damage distribution'
	},
	data: [{
		type: "pie",
        toolTipContent: "{label} - #percent %",
		indexLabel: "{label} {y}",
        legendText: "{indexLabel}",
        dataPoints: players.map(({name, games})=>({
            label: name,
            y: games.reduce((acc, curr)=>(acc+curr.damage),0)
        })),
	}]
}

const options3 = {
        width: 500,
      title: {
        text: "Kill Per Game"
      },
      toolTip: {
		shared: true
	},
      data: players.map(({name, games})=>({
        type: "column",
        name,
        showInLegend: true, 
        legendText: name,
        dataPoints: games.map(({id, kill})=>({
            label: `Game${id}`, y: kill
        }))
    }))
   }

   const options4 = {
	animationEnabled: true,
	title: {
		text: 'Total Kill distribution'
	},
	data: [{
		type: "pie",
        toolTipContent: "{label} - #percent %",
		indexLabel: "{label} {y}",
        legendText: "{indexLabel}",
        dataPoints: players.map(({name, games})=>({
            label: name,
            y: games.reduce((acc, curr)=>(acc+curr.kill),0)
        })),
	}]
}

const getPicFromName = ({name, games}) => {
    const m = games.reduce((acc, curr)=>{
            if(!acc[curr.legend]){
                acc[curr.legend] = 0;
            }
            acc[curr.legend] += 1;
            return acc
        },{})
        const l = Object.keys(m).reduce((a, b) => m[a] > m[b] ? a : b);
        return (name === 'LonelyLok' ? <img src='https://upload.wikimedia.org/wikipedia/commons/thumb/9/94/Stick_Figure.svg/800px-Stick_Figure.svg.png' width = "100%" height = "20%"></img> :<img src={pictureMap[l]} width = "100%" height = "100%"></img>)
}
   

        const testCard = (
        <div>
            <Card inverse style={{ backgroundColor: '#333', borderColor: '#333', width: '18rem' }}>
                <CardBody>
                    <CardTitle tag="h5">Total Game Played: {gameChampData.length}</CardTitle>
                    <CardText>Total Win: {gameChampData.filter(({cham})=>cham).length}</CardText>
                    </CardBody>
                </Card>
            </div>
    )

    const testCard2 = (a) => (a.map(b=>(
        <div class='column'>
            <Card inverse style={{ backgroundColor: 'blue', borderColor: '#333', width: '12rem' }}>
                {getPicFromName(b)}
                <CardBody>
                    <CardText>Player name: {b.name}</CardText>
                    </CardBody>
                </Card>
            </div>
    )))

    class Body extends React.Component {
        componentDidMount() {
        const chart = new CanvasJS.Chart('c1',  options1);
        const chart2 = new CanvasJS.Chart('c2',  options2);
        const chart3 = new CanvasJS.Chart('c3',  options3);
        const chart4 = new CanvasJS.Chart('c4',  options4);
        chart.render();
        chart2.render();
        chart3.render();
        chart4.render();
        return;
    }
  render() {
    return (<div>
    <h1>My apex game record {date}</h1>
    <p>{testCard}</p>
    <div class='row'>{testCard2(players)}</div>
    </div>)
  }
}
ReactDOM.render(<Body />, document.getElementById('mydiv'))
</script>
</body>
</html>